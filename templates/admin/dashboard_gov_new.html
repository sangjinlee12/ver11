{% extends "base_gov.html" %}

{% block title %}에스에스전력 - 관리자 대시보드{% endblock %}

{% block content %}
<div class="gov-breadcrumb">
    <a href="{{ url_for('main.dashboard') }}">홈</a>
    <i class="fas fa-chevron-right"></i>
    <span>관리자 대시보드</span>
</div>

<div class="gov-page-header">
    <h1 class="gov-page-title">
        <i class="fas fa-tachometer-alt"></i> 관리자 대시보드
    </h1>
    <p class="gov-page-subtitle">에스에스전력 인사관리시스템 전체 현황을 관리하고 모니터링할 수 있습니다.</p>
</div>

<!-- 주요 통계 현황 -->
<div class="gov-card">
    <div class="gov-card-header">
        <span><i class="fas fa-chart-bar"></i> 주요 현황</span>
        <small style="color: var(--gov-text-light);">{{ "now"|strftime('%Y년 %m월 %d일 기준') }}</small>
    </div>
    <div class="gov-card-body">
        <div class="gov-grid gov-grid-4">
            <!-- 전체 직원 수 -->
            <div style="text-align: center; padding: 20px; background: linear-gradient(135deg, var(--gov-blue-light), #f0f8ff); border-radius: 8px; border: 1px solid var(--gov-border);">
                <div style="background: var(--gov-blue); color: white; width: 60px; height: 60px; border-radius: 50%; display: flex; align-items: center; justify-content: center; margin: 0 auto 12px; font-size: 24px;">
                    <i class="fas fa-users"></i>
                </div>
                <div style="font-size: 28px; font-weight: 700; color: var(--gov-blue); margin-bottom: 4px;">{{ total_employees }}명</div>
                <div style="font-size: 13px; color: var(--gov-text-light);">전체 직원 수</div>
            </div>

            <!-- 승인 대기 휴가 -->
            <div style="text-align: center; padding: 20px; background: linear-gradient(135deg, #d4edda, #c3e6cb); border-radius: 8px; border: 1px solid #c3e6cb;">
                <div style="background: var(--gov-success); color: white; width: 60px; height: 60px; border-radius: 50%; display: flex; align-items: center; justify-content: center; margin: 0 auto 12px; font-size: 24px;">
                    <i class="fas fa-calendar-check"></i>
                </div>
                <div style="font-size: 28px; font-weight: 700; color: var(--gov-success); margin-bottom: 4px;">{{ pending_vacations }}건</div>
                <div style="font-size: 13px; color: var(--gov-text-light);">승인 대기 휴가</div>
            </div>

            <!-- 증명서 발급 대기 -->
            <div style="text-align: center; padding: 20px; background: linear-gradient(135deg, #fff3cd, #ffeaa7); border-radius: 8px; border: 1px solid #ffeaa7;">
                <div style="background: var(--gov-warning); color: white; width: 60px; height: 60px; border-radius: 50%; display: flex; align-items: center; justify-content: center; margin: 0 auto 12px; font-size: 24px;">
                    <i class="fas fa-certificate"></i>
                </div>
                <div style="font-size: 28px; font-weight: 700; color: #856404; margin-bottom: 4px;">{{ pending_certificates }}건</div>
                <div style="font-size: 13px; color: var(--gov-text-light);">증명서 발급 대기</div>
            </div>

            <!-- 등록된 공휴일 -->
            <div style="text-align: center; padding: 20px; background: linear-gradient(135deg, #f8d7da, #f5c6cb); border-radius: 8px; border: 1px solid #f5c6cb;">
                <div style="background: #6c5ce7; color: white; width: 60px; height: 60px; border-radius: 50%; display: flex; align-items: center; justify-content: center; margin: 0 auto 12px; font-size: 24px;">
                    <i class="fas fa-calendar-alt"></i>
                </div>
                <div style="font-size: 28px; font-weight: 700; color: #6c5ce7; margin-bottom: 4px;">{{ total_holidays }}일</div>
                <div style="font-size: 13px; color: var(--gov-text-light);">등록된 공휴일</div>
            </div>
        </div>
    </div>
</div>

<!-- 관리 메뉴 -->
<div class="gov-card">
    <div class="gov-card-header">
        <span><i class="fas fa-cogs"></i> 관리 메뉴</span>
    </div>
    <div class="gov-card-body">
        <div class="gov-grid gov-grid-2">
            <!-- 직원 관리 -->
            <div style="border: 1px solid var(--gov-border); border-radius: 8px; padding: 20px; background: var(--gov-white);">
                <h3 style="color: var(--gov-blue); margin-bottom: 12px; display: flex; align-items: center; gap: 8px;">
                    <i class="fas fa-users"></i> 직원 관리
                </h3>
                <p style="color: var(--gov-text-light); font-size: 14px; margin-bottom: 15px; line-height: 1.5;">
                    직원 정보 관리, 신규 등록, 부서 및 직급 설정을 할 수 있습니다.
                </p>
                <div style="display: flex; gap: 8px;">
                    <a href="{{ url_for('admin.manage_employees') }}" class="gov-btn gov-btn-primary" style="flex: 1;">
                        <i class="fas fa-list"></i> 직원 목록
                    </a>
                    <a href="{{ url_for('admin.set_vacation_days') }}" class="gov-btn gov-btn-secondary" style="flex: 1;">
                        <i class="fas fa-calendar"></i> 연차 설정
                    </a>
                </div>
            </div>

            <!-- 휴가 관리 -->
            <div style="border: 1px solid var(--gov-border); border-radius: 8px; padding: 20px; background: var(--gov-white);">
                <h3 style="color: var(--gov-success); margin-bottom: 12px; display: flex; align-items: center; gap: 8px;">
                    <i class="fas fa-calendar-check"></i> 휴가 관리
                </h3>
                <p style="color: var(--gov-text-light); font-size: 14px; margin-bottom: 15px; line-height: 1.5;">
                    휴가 신청 승인/반려, 휴가 현황 조회 및 통계를 확인할 수 있습니다.
                </p>
                <div style="display: flex; gap: 8px;">
                    <a href="{{ url_for('admin.manage_vacations') }}" class="gov-btn gov-btn-success" style="flex: 1;">
                        <i class="fas fa-tasks"></i> 휴가 승인
                    </a>
                    <a href="{{ url_for('admin.manage_vacations') }}" class="gov-btn gov-btn-secondary" style="flex: 1;">
                        <i class="fas fa-chart-line"></i> 현황 조회
                    </a>
                </div>
            </div>

            <!-- 증명서 관리 -->
            <div style="border: 1px solid var(--gov-border); border-radius: 8px; padding: 20px; background: var(--gov-white);">
                <h3 style="color: var(--gov-warning); margin-bottom: 12px; display: flex; align-items: center; gap: 8px;">
                    <i class="fas fa-certificate"></i> 증명서 관리
                </h3>
                <p style="color: var(--gov-text-light); font-size: 14px; margin-bottom: 15px; line-height: 1.5;">
                    재직증명서, 경력증명서 등 각종 증명서 발급을 관리합니다.
                </p>
                <div style="display: flex; gap: 8px;">
                    <a href="{{ url_for('admin.manage_certificates') }}" class="gov-btn gov-btn-warning" style="flex: 1;">
                        <i class="fas fa-file-contract"></i> 발급 관리
                    </a>
                    <a href="{{ url_for('admin.manage_company_info') }}" class="gov-btn gov-btn-secondary" style="flex: 1;">
                        <i class="fas fa-building"></i> 회사 정보
                    </a>
                </div>
            </div>

            <!-- 시스템 관리 -->
            <div style="border: 1px solid var(--gov-border); border-radius: 8px; padding: 20px; background: var(--gov-white);">
                <h3 style="color: #6c5ce7; margin-bottom: 12px; display: flex; align-items: center; gap: 8px;">
                    <i class="fas fa-calendar-alt"></i> 시스템 관리
                </h3>
                <p style="color: var(--gov-text-light); font-size: 14px; margin-bottom: 15px; line-height: 1.5;">
                    공휴일 관리, 시스템 설정 및 기타 관리 기능을 제공합니다.
                </p>
                <div style="display: flex; gap: 8px;">
                    <a href="{{ url_for('admin.manage_holidays') }}" class="gov-btn" style="background: #6c5ce7; color: white; flex: 1;">
                        <i class="fas fa-calendar-plus"></i> 공휴일 관리
                    </a>
                    <a href="{{ url_for('admin.set_hire_date') }}" class="gov-btn gov-btn-secondary" style="flex: 1;">
                        <i class="fas fa-user-clock"></i> 입사일 설정
                    </a>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- 최근 활동 -->
<div class="gov-grid gov-grid-2">
    <!-- 최근 휴가 신청 -->
    <div class="gov-card">
        <div class="gov-card-header">
            <span><i class="fas fa-clock"></i> 최근 휴가 신청</span>
            <a href="{{ url_for('admin.manage_vacations') }}" style="color: var(--gov-blue); font-size: 13px; text-decoration: none;">
                <i class="fas fa-external-link-alt"></i> 전체보기
            </a>
        </div>
        <div class="gov-card-body">
            {% if recent_vacations %}
                <div style="max-height: 300px; overflow-y: auto;">
                    {% for vacation in recent_vacations %}
                    <div style="display: flex; justify-content: space-between; align-items: center; padding: 12px 0; border-bottom: 1px solid var(--gov-border);">
                        <div>
                            <div style="font-weight: 600; color: var(--gov-text);">{{ vacation.user.name }}</div>
                            <div style="font-size: 13px; color: var(--gov-text-light);">
                                {{ vacation.start_date.strftime('%m/%d') }} - {{ vacation.end_date.strftime('%m/%d') }} ({{ vacation.days }}일)
                            </div>
                        </div>
                        <div style="text-align: right;">
                            <span class="gov-badge gov-badge-{{ 'warning' if vacation.status.value == 'pending' else 'success' if vacation.status.value == 'approved' else 'danger' }}">
                                {{ vacation.status.value }}
                            </span>
                        </div>
                    </div>
                    {% endfor %}
                </div>
            {% else %}
                <div style="text-align: center; padding: 40px; color: var(--gov-text-light);">
                    <i class="fas fa-inbox" style="font-size: 48px; margin-bottom: 10px; opacity: 0.3;"></i>
                    <p>최근 휴가 신청이 없습니다.</p>
                </div>
            {% endif %}
        </div>
    </div>

    <!-- 최근 증명서 신청 -->
    <div class="gov-card">
        <div class="gov-card-header">
            <span><i class="fas fa-file-alt"></i> 최근 증명서 신청</span>
            <a href="{{ url_for('admin.manage_certificates') }}" style="color: var(--gov-blue); font-size: 13px; text-decoration: none;">
                <i class="fas fa-external-link-alt"></i> 전체보기
            </a>
        </div>
        <div class="gov-card-body">
            {% if recent_certificates %}
                <div style="max-height: 300px; overflow-y: auto;">
                    {% for cert in recent_certificates %}
                    <div style="display: flex; justify-content: space-between; align-items: center; padding: 12px 0; border-bottom: 1px solid var(--gov-border);">
                        <div>
                            <div style="font-weight: 600; color: var(--gov-text);">{{ cert.user.name }}</div>
                            <div style="font-size: 13px; color: var(--gov-text-light);">
                                {{ cert.certificate_type.value }} | {{ cert.created_at.strftime('%m/%d %H:%M') }}
                            </div>
                        </div>
                        <div style="text-align: right;">
                            <span class="gov-badge gov-badge-{{ 'warning' if cert.status.value == 'pending' else 'success' if cert.status.value == 'completed' else 'danger' }}">
                                {{ cert.status.value }}
                            </span>
                        </div>
                    </div>
                    {% endfor %}
                </div>
            {% else %}
                <div style="text-align: center; padding: 40px; color: var(--gov-text-light);">
                    <i class="fas fa-inbox" style="font-size: 48px; margin-bottom: 10px; opacity: 0.3;"></i>
                    <p>최근 증명서 신청이 없습니다.</p>
                </div>
            {% endif %}
        </div>
    </div>
</div>

<style>
/* 배지 스타일 */
.gov-badge {
    display: inline-block;
    padding: 4px 8px;
    font-size: 12px;
    font-weight: 600;
    border-radius: 4px;
    text-transform: uppercase;
}

.gov-badge-warning {
    background: #fff3cd;
    color: #856404;
    border: 1px solid #ffeaa7;
}

.gov-badge-success {
    background: #d4edda;
    color: #155724;
    border: 1px solid #c3e6cb;
}

.gov-badge-danger {
    background: #f8d7da;
    color: #721c24;
    border: 1px solid #f5c6cb;
}
</style>
{% endblock %}